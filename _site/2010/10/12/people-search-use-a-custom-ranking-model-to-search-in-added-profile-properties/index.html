
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>People Search: Use a custom Ranking Model to search in added Profile Properties</title>
    
    <meta name="author" content="Peter Gerritsen">

    <!-- Enable responsive viewport -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le styles -->
    <link href="/assets/themes/twitter/bootstrap/css/bootstrap.2.2.2.min.css" rel="stylesheet">
    <link href="/assets/themes/twitter/css/style.css?body=1" rel="stylesheet" type="text/css" media="all">

    <!-- Le fav and touch icons -->
  <!-- Update these with your own images
    <link rel="shortcut icon" href="images/favicon.ico">
    <link rel="apple-touch-icon" href="images/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">
  -->

    <!-- atom & rss feed -->
    <link href="/atom.xml" type="application/atom+xml" rel="alternate" title="Sitewide ATOM Feed">
    <link href="/rss.xml" type="application/rss+xml" rel="alternate" title="Sitewide RSS Feed">

  </head>

  <body>
    <div class="navbar">
      <div class="navbar-inner">
        <div class="container-narrow">
          <a class="brand" href="/">Peter Gerritsenâ€™s blog</a>
          <ul class="nav">
            
            
            


  
    
      
      	
      	<li><a href="/archive.html">Archive</a></li>
      	
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/categories.html">Categories</a></li>
      	
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/pages.html">Pages</a></li>
      	
      
    
  
    
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/tags.html">Tags</a></li>
      	
      
    
  



          </ul>
        </div>
      </div>
    </div>

    <div class="container-narrow">

      <div class="content">
        
<div class="page-header">
  <h1>People Search: Use a custom Ranking Model to search in added Profile Properties </h1>
</div>

<div class="row-fluid post-full">
  <div class="span12">
    <div class="date">
      <span>12 October 2010</span>
    </div>
    <div class="content">
      <p>When you use the out-of-the box components for searching for people, a generic search with a keyword that is included in an added Profile property will not give the results you might expect.</p>

<p>This is especially a problem with the out-of-the-box webpart that shows information about a person:</p>

<p><a href='http://blog.petergerritsen.nl/wp-content/uploads/2010/10/Profile-properties-webpart.png'><img alt='' src='http://blog.petergerritsen.nl/wp-content/uploads/2010/10/Profile-properties-webpart-300x103.png' /></a> When you click on one of the values in this webpart, you will be redirected to the people search results page with the value you clicked passed in as the search keyword:</p>

<p><a href='http://blog.petergerritsen.nl/wp-content/uploads/2010/10/Profile-search-generic.png'><img alt='' src='http://blog.petergerritsen.nl/wp-content/uploads/2010/10/Profile-search-generic-300x105.png' /></a> But this will not give you any results. <a href='http://kgraeme.wordpress.com/2010/07/28/sharepoint-user-profile-custom-properties-keyword-search-problem/'>This post</a> by kgreame outlines the same problems and some of the steps he tried to solve this issue. In the comments to that post, a workaround is mentioned: map the matching crawled properties to the ContentsHidden Managed Property. There is however an other way. In <a href='http://sharepoint.microsoft.com/blogs/LKuhn/Lists/Posts/Post.aspx?List=29310d0a-1eda-4834-bb4c-06ee575a40c3&amp;ID=52'>this post</a> by Larry Kuhn, he explains how the DEFAULTPROPERTIES within the SharePoint Search work. By setting a weight of a Managed Property, you will include it in the ranking model SharePoint uses and the property is therefore added to the default properties that are searched. SharePoint 2010 introduces the concept of Ranking Models, so the solution mentioned in that blogpost doesn&#8217;t work. We can however create our own Ranking Model. I&#8217;ve copied the information from the Ranking Model that SharePoint uses for People Search and added my own Managed Property, Expertise, with a weight of 1.0: <code>xml
&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;rankingModel name=&quot;CustomPeopleRanking&quot; id=&quot;5EA2750C-8165-4f65-BD12-6E6DAAD45FE0&quot; description=&quot;Custom People Ranking&quot; xmlns=&quot;http://schemas.microsoft.com/office/2009/rankingModel&quot;&gt;
  &lt;queryDependentFeatures&gt;
    &lt;queryDependentFeature pid=&quot;177&quot; name=&quot;RankingWeightName&quot; weight=&quot;0.5&quot; lengthNormalization=&quot;0&quot; /&gt;
    &lt;queryDependentFeature pid=&quot;19&quot; name=&quot;PreferredName&quot; weight=&quot;1.0&quot; lengthNormalization=&quot;0&quot; /&gt;
    &lt;queryDependentFeature pid=&quot;24&quot; name=&quot;JobTitle&quot; weight=&quot;2.0&quot; lengthNormalization=&quot;0&quot; /&gt;
    &lt;queryDependentFeature pid=&quot;39&quot; name=&quot;Responsibilities&quot; weight=&quot;1.0&quot; lengthNormalization=&quot;5&quot; /&gt;
    &lt;queryDependentFeature pid=&quot;179&quot; name=&quot;RankingWeightLow&quot; weight=&quot;0.2&quot; lengthNormalization=&quot;5&quot; /&gt;
    &lt;queryDependentFeature pid=&quot;175&quot; name=&quot;ContentsHidden&quot; weight=&quot;0.1&quot; lengthNormalization=&quot;5&quot; /&gt;
    &lt;queryDependentFeature pid=&quot;35&quot; name=&quot;Memberships&quot; weight=&quot;0.25&quot; lengthNormalization=&quot;5&quot; /&gt;
    &lt;queryDependentFeature pid=&quot;178&quot; name=&quot;RankingWeightHigh&quot; weight=&quot;2.0&quot; lengthNormalization=&quot;0&quot; /&gt;
    &lt;queryDependentFeature pid=&quot;180&quot; name=&quot;Pronunciations&quot; weight=&quot;0.05&quot; lengthNormalization=&quot;0&quot; /&gt;
    &lt;queryDependentFeature pid=&quot;408&quot; name=&quot;Expertise&quot; weight=&quot;1.0&quot; lengthNormalization=&quot;0&quot; /&gt;
  &lt;/queryDependentFeatures&gt;
&lt;/rankingModel&gt;
</code> We can then add this Ranking Model to SharePoint with Powershell: <code>
Get-SPEnterpriseSearchServiceApplication | New-SPEnterpriseSearchRankingModel
</code> And paste in the XML of this Ranking Model when Powershell prompts you for it.</p>

<p>But how do we force SharePoint to use this Ranking Model? I&#8217;ve outlined one of the solutions in a <a href='http://blog.petergerritsen.nl/2010/10/11/let-the-sharepoint-search-web-parts-use-an-other-ranking-model/'>previous post</a>.</p>

<p>So after adding a web part that sets the ranking model we can perform the search again:</p>

<p><a href='http://blog.petergerritsen.nl/wp-content/uploads/2010/10/Profile-search-after-ranking-model.png'><img alt='' src='http://blog.petergerritsen.nl/wp-content/uploads/2010/10/Profile-search-after-ranking-model-300x139.png' /></a> And bingo, the user with this value in an extra profile property shows up in the search results.</p>

<p>Why use this over mapping the properties in the &#8216;ContentsHidden&#8217; Managed Property? As you can see the &#8216;ContentsHidden&#8217; property is included in the Ranking Model with a value of 0.1. If you want to give more weight to a custom property or you have more properties to which you want to assign a different weight, you will need to modify the Ranking Model.</p>
    </div>

    

  
    <ul class="tag_box inline">
      <li><i class="icon-tags"></i></li>
      
      


  
     
    	<li><a href="/tags.html#Search-ref">Search <span>5</span></a></li>
     
    	<li><a href="/tags.html#SharePoint Profile System-ref">SharePoint Profile System <span>2</span></a></li>
     
    	<li><a href="/tags.html#SP2010-ref">SP2010 <span>20</span></a></li>
    
  



    </ul>
    

    <hr>
    <div class="pagination">
      <ul>
      
        <li class="prev"><a href="/2010/10/11/let-the-sharepoint-search-web-parts-use-an-other-ranking-model" title="Let the SharePoint Search web parts use an other Ranking Model">&larr; Previous</a></li>
      
        <li><a href="/archive.html">Archive</a></li>
      
        <li class="next"><a href="/2010/10/26/install-help-collection-files-for-a-different-language-in-sharepoint-2010" title="Install Help Collection files for a different language in SharePoint 2010">Next &rarr;</a></li>
      
      </ul>
    </div>
    <hr>
    


  <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_developer = 1;
    var disqus_shortname = 'jekyllbootstrap'; // required: replace example with your forum shortname
    var disqus_identifier = '855 http://username.github.io/?p=855';
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>




  </div>
</div>


      </div>
      <hr>
      <footer>
        <p>&copy; 2013 Peter Gerritsen
          with help from <a href="http://jekyllbootstrap.com" target="_blank" title="The Definitive Jekyll Blogging Framework">Jekyll Bootstrap</a>
          and <a href="http://twitter.github.com/bootstrap/" target="_blank">Twitter Bootstrap</a>
        </p>
      </footer>

    </div>

    
  </body>
</html>

