
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>New sample project for SP2010 Word Automation: UI</title>
    
    <meta name="author" content="Peter Gerritsen">

    <!-- Enable responsive viewport -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le styles -->
    <link href="/assets/themes/twitter/bootstrap/css/bootstrap.2.2.2.min.css" rel="stylesheet">
    <link href="/assets/themes/twitter/css/style.css?body=1" rel="stylesheet" type="text/css" media="all">

    <!-- Le fav and touch icons -->
  <!-- Update these with your own images
    <link rel="shortcut icon" href="images/favicon.ico">
    <link rel="apple-touch-icon" href="images/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">
  -->

    <!-- atom & rss feed -->
    <link href="/atom.xml" type="application/atom+xml" rel="alternate" title="Sitewide ATOM Feed">
    <link href="/rss.xml" type="application/rss+xml" rel="alternate" title="Sitewide RSS Feed">

  </head>

  <body>
    <div class="navbar">
      <div class="navbar-inner">
        <div class="container-narrow">
          <a class="brand" href="/">Peter Gerritsen’s blog</a>
          <ul class="nav">
            
            
            


  
    
      
      	
      	<li><a href="/archive.html">Archive</a></li>
      	
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/categories.html">Categories</a></li>
      	
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/pages.html">Pages</a></li>
      	
      
    
  
    
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/tags.html">Tags</a></li>
      	
      
    
  



          </ul>
        </div>
      </div>
    </div>

    <div class="container-narrow">

      <div class="content">
        
<div class="page-header">
  <h1>New sample project for SP2010 Word Automation: UI </h1>
</div>

<div class="row-fluid post-full">
  <div class="span12">
    <div class="date">
      <span>02 March 2010</span>
    </div>
    <div class="content">
      <p>I’ve just published a <a href='http://sp2010wordautomation.codeplex.com/releases/view/41267'>second sample solution</a> for the SP2010 Word Automation project on CodePlex. This solution will add a button to the Ribbon when browsing document libraries:</p>

<p><a href='http://blog.petergerritsen.nl/wp-content/uploads/image9.png'><img alt='Ribbon button' src='http://blog.petergerritsen.nl/wp-content/uploads/image_thumb10.png' /></a></p>

<p>When the button is clicked a modal Dialog is shown that will allow the user to specify the options used for conversion:</p>

<p><a href='http://blog.petergerritsen.nl/wp-content/uploads/image10.png'><img alt='Modal Dialog' src='http://blog.petergerritsen.nl/wp-content/uploads/image_thumb11.png' /></a></p>

<p>When the Ok button is clicked the selected files will be added to a conversion job and the job will be started.</p>

<p>The dialog is launched by some javascript that is specified in the CommandUIHandler section of the ribbon button definition.</p>

<p><code>xml
&lt;commandUIHandler
Command=&quot;SP2010WA_Convert_Button&quot;
CommandAction=&quot;javascript:function convertDocument() {
Sys.loadScripts([&#39;/_layouts/SP2010WordAutomation.UI/SP2010WordAutomation.UI.js&#39;], function() {
SP2010WordAutomation.UI.ConvertDocument();
});
}
convertDocument();&quot;
EnabledScript=&quot;javascript:function oneOrMoreEnable() {
var items = SP.ListOperation.Selection.getSelectedItems();
var ci = CountDictionary(items);
return (ci &gt; 0);
}
oneOrMoreEnable();&quot; /&gt;
</code></p>

<p>I’ve decided to use the beta version of the ASP.Net 4.0 AJAX client library to load the required scriptfile when it is actually needed. While this is not completely necessary in this case, because the amount of script in there is quite little, it could provide a speedboost because the browser won’t load and interpret the script when the page loads.</p>

<p>The definition also contains some script to enable the button only when one or more files are selected.</p>

<p>The following lists the script that is loaded and called when the button is clicked:</p>

<p><code>javascript
Type.registerNamespace(&quot;SP2010WordAutomation.UI&quot;);
SP2010WordAutomation.UI.ConvertDocument = function () {
var items = SP.ListOperation.Selection.getSelectedItems();
var selectedItems = &#39;&#39;;
var k;
for (k in items) {
selectedItems += &#39;|&#39; + items[k].id;
}
var options = {
url: &#39;/_layouts/SP2010WordAutomation.UI/ConvertDocument.aspx?items=&#39; + selectedItems + &#39;&amp;source;=&#39; + SP.ListOperation.Selection.getSelectedList(),
title: &#39;Convert Documents&#39;,
allowMaximize: false,
showClose: true,
width: 600,
height: 480,
dialogReturnValueCallback: SP2010WordAutomation.UI.ConvertCallback
};
SP.UI.ModalDialog.showModalDialog(options);
}
SP2010WordAutomation.UI.ConvertCallback = function(result, target) {
SP.UI.Notify.addNotification(target, false);
SP.UI.ModalDialog.RefreshPage(result);
}
</code></p>

<p>First I use the <em>Type.registerNamespace</em> method that is provided by the standard SharePoint scriptlibrary to make sure I don’t override other methods with the same names.</p>

<p>In the <em>ConvertDocument</em> function we then launch a SharePoint dialog that will load an ApplicationPage which provides the user with the options they can choose. The <em>ConvertCallback</em> function which is called when the dialog passes a result will add a notification message to the main screen.</p>

<p>To see how this mechanism can be used, please refer to <a href='http://blogs.msdn.com/vesku/archive/2010/02/25/how-to-sharepoint-2010-js-client-object-model-and-ui-advancements.aspx'>this post</a> by Vesa Juvonen</p>
    </div>

    

  
    <ul class="tag_box inline">
      <li><i class="icon-tags"></i></li>
      
      


  
     
    	<li><a href="/tags.html#CodePlex-ref">CodePlex <span>3</span></a></li>
     
    	<li><a href="/tags.html#SP2010-ref">SP2010 <span>20</span></a></li>
     
    	<li><a href="/tags.html#Word Automation-ref">Word Automation <span>3</span></a></li>
    
  



    </ul>
    

    <hr>
    <div class="pagination">
      <ul>
      
        <li class="prev"><a href="/2010/02/18/2-new-worflow-activities-added-to-sp2010-word-automation" title="2 new worflow activities added to SP2010 Word Automation">&larr; Previous</a></li>
      
        <li><a href="/archive.html">Archive</a></li>
      
        <li class="next"><a href="/2010/05/12/tam-tam-lauches-soccerino-world-cup-2010-pool-for-sharepoint-and-facebook" title="Tam Tam Lauches Soccerino - World Cup 2010 Pool for SharePoint AND Facebook">Next &rarr;</a></li>
      
      </ul>
    </div>
    <hr>
    


  <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_developer = 1;
    var disqus_shortname = 'jekyllbootstrap'; // required: replace example with your forum shortname
    var disqus_identifier = '782 http://username.github.io/?p=782';
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>




  </div>
</div>


      </div>
      <hr>
      <footer>
        <p>&copy; 2013 Peter Gerritsen
          with help from <a href="http://jekyllbootstrap.com" target="_blank" title="The Definitive Jekyll Blogging Framework">Jekyll Bootstrap</a>
          and <a href="http://twitter.github.com/bootstrap/" target="_blank">Twitter Bootstrap</a>
        </p>
      </footer>

    </div>

    
  </body>
</html>

